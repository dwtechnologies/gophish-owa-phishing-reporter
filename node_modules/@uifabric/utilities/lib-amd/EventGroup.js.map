{"version":3,"file":"EventGroup.js","sourceRoot":"../src/","sources":["EventGroup.ts"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable:no-string-literal */\nimport { assign } from './object';\n\n/**\n * EventRecord interface.\n *\n * @internal\n */\n// tslint:disable:no-any\nexport interface IEventRecord {\n  target: any;\n  eventName: string;\n  parent: any;\n  callback: (args?: any) => void;\n  elementCallback?: (...args: any[]) => void;\n  objectCallback?: (args?: any) => void;\n  options?: boolean | AddEventListenerOptions;\n}\n// tslint:enable:no-any\n\n/**\n * EventRecordsByName interface.\n *\n * @internal\n */\nexport interface IEventRecordsByName {\n  [eventName: string]: IEventRecordList;\n}\n\n/**\n * EventRecordList interface.\n *\n * @internal\n */\nexport interface IEventRecordList {\n  [id: string]: IEventRecord[] | number;\n  count: number;\n}\n\n/**\n * DeclaredEventsByName interface.\n *\n * @internal\n */\nexport interface IDeclaredEventsByName {\n  [eventName: string]: boolean;\n}\n\n/** An instance of EventGroup allows anything with a handle to it to trigger events on it.\n *  If the target is an HTMLElement, the event will be attached to the element and can be\n *  triggered as usual (like clicking for onclick).\n *  The event can be triggered by calling EventGroup.raise() here. If the target is an\n *  HTMLElement, the event gets raised and is handled by the browser. Otherwise, it gets\n *  handled here in EventGroup, and the handler is called in the context of the parent\n *  (which is passed in in the constructor).\n *\n * @public\n * {@docCategory EventGroup}\n */\nexport class EventGroup {\n  // tslint:disable-next-line:no-inferrable-types\n  private static _uniqueId: number = 0;\n  // tslint:disable-next-line:no-any\n  private _parent: any;\n  private _eventRecords: IEventRecord[];\n  private _id: number = EventGroup._uniqueId++;\n  private _isDisposed: boolean;\n\n  /** For IE8, bubbleEvent is ignored here and must be dealt with by the handler.\n   *  Events raised here by default have bubbling set to false and cancelable set to true.\n   *  This applies also to built-in events being raised manually here on HTMLElements,\n   *  which may lead to unexpected behavior if it differs from the defaults.\n   *\n   */\n  public static raise(\n    // tslint:disable-next-line:no-any\n    target: any,\n    eventName: string,\n    // tslint:disable-next-line:no-any\n    eventArgs?: any,\n    bubbleEvent?: boolean\n  ): boolean | undefined {\n    let retVal;\n\n    if (EventGroup._isElement(target)) {\n      if (typeof document !== 'undefined' && document.createEvent) {\n        let ev = document.createEvent('HTMLEvents');\n\n        ev.initEvent(eventName, bubbleEvent || false, true);\n\n        assign(ev, eventArgs);\n\n        retVal = target.dispatchEvent(ev);\n        // tslint:disable-next-line:no-any\n      } else if (typeof document !== 'undefined' && (document as any)['createEventObject']) {\n        // IE8\n        // tslint:disable-next-line:no-any\n        let evObj = (document as any)['createEventObject'](eventArgs);\n        // cannot set cancelBubble on evObj, fireEvent will overwrite it\n        target.fireEvent('on' + eventName, evObj);\n      }\n    } else {\n      while (target && retVal !== false) {\n        let events = <IEventRecordsByName>target.__events__;\n        let eventRecords = events ? events[eventName] : null;\n\n        if (eventRecords) {\n          for (let id in eventRecords) {\n            if (eventRecords.hasOwnProperty(id)) {\n              let eventRecordList = <IEventRecord[]>eventRecords[id];\n\n              for (let listIndex = 0; retVal !== false && listIndex < eventRecordList.length; listIndex++) {\n                let record = eventRecordList[listIndex];\n\n                if (record.objectCallback) {\n                  retVal = record.objectCallback.call(record.parent, eventArgs);\n                }\n              }\n            }\n          }\n        }\n\n        // If the target has a parent, bubble the event up.\n        target = bubbleEvent ? target.parent : null;\n      }\n    }\n\n    return retVal;\n  }\n\n  // tslint:disable-next-line:no-any\n  public static isObserved(target: any, eventName: string): boolean {\n    let events = target && <IEventRecordsByName>target.__events__;\n\n    return !!events && !!events[eventName];\n  }\n\n  /** Check to see if the target has declared support of the given event. */\n  // tslint:disable-next-line:no-any\n  public static isDeclared(target: any, eventName: string): boolean {\n    let declaredEvents = target && <IDeclaredEventsByName>target.__declaredEvents;\n\n    return !!declaredEvents && !!declaredEvents[eventName];\n  }\n\n  // tslint:disable-next-line:no-any\n  public static stopPropagation(event: any): void {\n    if (event.stopPropagation) {\n      event.stopPropagation();\n    } else {\n      // IE8\n      event.cancelBubble = true;\n    }\n  }\n\n  private static _isElement(target: HTMLElement): boolean {\n    return !!target && (!!target.addEventListener || (typeof HTMLElement !== 'undefined' && target instanceof HTMLElement));\n  }\n\n  /** parent: the context in which events attached to non-HTMLElements are called */\n  // tslint:disable-next-line:no-any\n  public constructor(parent: any) {\n    this._parent = parent;\n    this._eventRecords = [];\n  }\n\n  public dispose(): void {\n    if (!this._isDisposed) {\n      this._isDisposed = true;\n\n      this.off();\n      this._parent = null;\n    }\n  }\n\n  /** On the target, attach a set of events, where the events object is a name to function mapping. */\n  // tslint:disable-next-line:no-any\n  public onAll(target: any, events: { [key: string]: (args?: any) => void }, useCapture?: boolean): void {\n    for (let eventName in events) {\n      if (events.hasOwnProperty(eventName)) {\n        this.on(target, eventName, events[eventName], useCapture);\n      }\n    }\n  }\n\n  /** On the target, attach an event whose handler will be called in the context of the parent\n   * of this instance of EventGroup.\n   */\n  // tslint:disable-next-line:no-any\n  public on(target: any, eventName: string, callback: (args?: any) => void, options?: boolean | AddEventListenerOptions): void {\n    if (eventName.indexOf(',') > -1) {\n      let events = eventName.split(/[ ,]+/);\n\n      for (let i = 0; i < events.length; i++) {\n        this.on(target, events[i], callback, options);\n      }\n    } else {\n      let parent = this._parent;\n      let eventRecord: IEventRecord = {\n        target: target,\n        eventName: eventName,\n        parent: parent,\n        callback: callback,\n        options\n      };\n\n      // Initialize and wire up the record on the target, so that it can call the callback if the event fires.\n      let events = <IEventRecordsByName>(target.__events__ = target.__events__ || {});\n      events[eventName] =\n        events[eventName] ||\n        <IEventRecordList>{\n          count: 0\n        };\n      events[eventName][this._id] = events[eventName][this._id] || [];\n      (<IEventRecord[]>events[eventName][this._id]).push(eventRecord);\n      events[eventName].count++;\n\n      if (EventGroup._isElement(target)) {\n        // tslint:disable-next-line:no-any\n        let processElementEvent = (...args: any[]) => {\n          if (this._isDisposed) {\n            return;\n          }\n\n          let result;\n          try {\n            result = callback.apply(parent, args);\n            if (result === false && args[0]) {\n              let e = args[0];\n\n              if (e.preventDefault) {\n                e.preventDefault();\n              }\n\n              if (e.stopPropagation) {\n                e.stopPropagation();\n              }\n\n              e.cancelBubble = true;\n            }\n          } catch (e) {\n            /* ErrorHelper.log(e); */\n          }\n\n          return result;\n        };\n\n        eventRecord.elementCallback = processElementEvent;\n\n        if (target.addEventListener) {\n          /* tslint:disable:ban-native-functions */\n          (<EventTarget>target).addEventListener(eventName, processElementEvent, options);\n          /* tslint:enable:ban-native-functions */\n        } else if (target.attachEvent) {\n          // IE8\n          target.attachEvent('on' + eventName, processElementEvent);\n        }\n      } else {\n        // tslint:disable-next-line:no-any\n        let processObjectEvent = (...args: any[]) => {\n          if (this._isDisposed) {\n            return;\n          }\n\n          return callback.apply(parent, args);\n        };\n\n        eventRecord.objectCallback = processObjectEvent;\n      }\n\n      // Remember the record locally, so that it can be removed.\n      this._eventRecords.push(eventRecord);\n    }\n  }\n\n  // tslint:disable-next-line:no-any\n  public off(target?: any, eventName?: string, callback?: (args?: any) => void, options?: boolean | AddEventListenerOptions): void {\n    for (let i = 0; i < this._eventRecords.length; i++) {\n      let eventRecord = this._eventRecords[i];\n      if (\n        (!target || target === eventRecord.target) &&\n        (!eventName || eventName === eventRecord.eventName) &&\n        (!callback || callback === eventRecord.callback) &&\n        (typeof options !== 'boolean' || options === eventRecord.options)\n      ) {\n        let events = <IEventRecordsByName>eventRecord.target.__events__;\n        let targetArrayLookup = events[eventRecord.eventName];\n        let targetArray = targetArrayLookup ? <IEventRecord[]>targetArrayLookup[this._id] : null;\n\n        // We may have already target's entries, so check for null.\n        if (targetArray) {\n          if (targetArray.length === 1 || !callback) {\n            targetArrayLookup.count -= targetArray.length;\n            delete events[eventRecord.eventName][this._id];\n          } else {\n            targetArrayLookup.count--;\n            targetArray.splice(targetArray.indexOf(eventRecord), 1);\n          }\n\n          if (!targetArrayLookup.count) {\n            delete events[eventRecord.eventName];\n          }\n        }\n\n        if (eventRecord.elementCallback) {\n          if (eventRecord.target.removeEventListener) {\n            eventRecord.target.removeEventListener(eventRecord.eventName, eventRecord.elementCallback, eventRecord.options);\n          } else if (eventRecord.target.detachEvent) {\n            // IE8\n            eventRecord.target.detachEvent('on' + eventRecord.eventName, eventRecord.elementCallback);\n          }\n        }\n\n        this._eventRecords.splice(i--, 1);\n      }\n    }\n  }\n\n  /** Trigger the given event in the context of this instance of EventGroup. */\n  // tslint:disable-next-line:no-any\n  public raise(eventName: string, eventArgs?: any, bubbleEvent?: boolean): boolean | undefined {\n    return EventGroup.raise(this._parent, eventName, eventArgs, bubbleEvent);\n  }\n\n  /** Declare an event as being supported by this instance of EventGroup. */\n  public declare(event: string | string[]): void {\n    let declaredEvents = (this._parent.__declaredEvents = this._parent.__declaredEvents || {});\n\n    if (typeof event === 'string') {\n      declaredEvents[event] = true;\n    } else {\n      for (let i = 0; i < event.length; i++) {\n        declaredEvents[event[i]] = true;\n      }\n    }\n  }\n}\n"]}