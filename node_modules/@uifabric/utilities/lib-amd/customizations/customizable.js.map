{"version":3,"file":"customizable.js","sourceRoot":"../src/","sources":["customizations/customizable.tsx"],"names":[],"mappings":";;;IAMA,SAAgB,YAAY,CAC1B,KAAa,EACb,MAAgB,EAChB,YAAsB;IACtB,kCAAkC;;QAElC,gDAAgD;QAChD,OAAO,SAAS,mBAAmB;QACjC,kCAAkC;QAClC,iBAAyC;QACzC,kCAAkC;;;YAElC,IAAM,WAAW;oBAA4C,sDAAsB;oBAGjF,kCAAkC;oBAClC,oCAAY,KAAQ;wBAApB,YACE,kBAAM,KAAK,CAAC,SAGb;wBADC,KAAI,CAAC,iBAAiB,GAAG,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;oBAC7D,CAAC;oBAEM,sDAAiB,GAAxB;wBACE,+BAAc,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;oBACjD,CAAC;oBAEM,yDAAoB,GAA3B;wBACE,+BAAc,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;oBACnD,CAAC;oBAEM,2CAAM,GAAb;wBAAA,iBAwBC;wBAvBC,OAAO,CACL,oBAAC,qCAAiB,CAAC,QAAQ,QACxB,UAAC,OAA2B;4BAC3B,IAAM,YAAY,GAAG,+BAAc,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;4BAEvF,kCAAkC;4BAClC,IAAM,cAAc,GAAG,KAAI,CAAC,KAAY,CAAC;4BAEzC,mFAAmF;4BACnF,IAAI,YAAY,CAAC,MAAM,IAAI,OAAO,YAAY,CAAC,MAAM,KAAK,UAAU,EAAE;gCACpE,YAAY,CAAC,MAAM,GAAG,YAAY,CAAC,MAAM,sBAAM,YAAY,EAAK,cAAc,EAAG,CAAC;6BACnF;4BAED,mFAAmF;4BACnF,IAAI,YAAY,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,cAAc,CAAC,MAAM,CAAC,EAAE;gCAClE,IAAM,YAAY,GAAG,8BAAe,CAAC,YAAY,CAAC,MAAM,EAAE,cAAc,CAAC,MAAM,CAAC,CAAC;gCACjF,OAAO,oBAAC,iBAAiB,uBAAK,YAAY,EAAM,cAAc,IAAE,MAAM,EAAE,YAAY,IAAI,CAAC;6BAC1F;4BAED,OAAO,oBAAC,iBAAiB,uBAAK,YAAY,EAAM,cAAc,EAAI,CAAC;wBACrE,CAAC,CAC0B,CAC9B,CAAC;oBACJ,CAAC;oBAEO,sDAAiB,GAAzB;wBACE,IAAI,CAAC,WAAW,EAAE,CAAC;oBACrB,CAAC;oBACH,iCAAC;gBAAD,CAAC,AA/CmB,CAAyC,KAAK,CAAC,SAAS;gBAC5D,cAAW,GAAW,YAAY,GAAG,KAAM;mBA8C1D,CAAC;YAEF,OAAO,2BAAY,CAAC,iBAAiB,EAAE,WAAW,CAAC,CAAC;QACtD,CAAC,CAAC;IACJ,CAAC;IA/DD,oCA+DC","sourcesContent":["import * as React from 'react';\nimport { Customizations } from './Customizations';\nimport { hoistStatics } from '../hoistStatics';\nimport { CustomizerContext, ICustomizerContext } from './CustomizerContext';\nimport { concatStyleSets } from '@uifabric/merge-styles';\n\nexport function customizable(\n  scope: string,\n  fields: string[],\n  concatStyles?: boolean\n  // tslint:disable-next-line:no-any\n): <P>(ComposedComponent: React.ComponentType<P>) => any {\n  // tslint:disable-next-line:no-shadowed-variable\n  return function customizableFactory<P>(\n    // tslint:disable-next-line:no-any\n    ComposedComponent: React.ComponentType<P>\n    // tslint:disable-next-line:no-any\n  ): any {\n    const resultClass = class ComponentWithInjectedProps extends React.Component<P, {}> {\n      public static displayName: string = 'Customized' + scope;\n\n      // tslint:disable-next-line:no-any\n      constructor(props: P) {\n        super(props);\n\n        this._onSettingChanged = this._onSettingChanged.bind(this);\n      }\n\n      public componentDidMount(): void {\n        Customizations.observe(this._onSettingChanged);\n      }\n\n      public componentWillUnmount(): void {\n        Customizations.unobserve(this._onSettingChanged);\n      }\n\n      public render(): JSX.Element {\n        return (\n          <CustomizerContext.Consumer>\n            {(context: ICustomizerContext) => {\n              const defaultProps = Customizations.getSettings(fields, scope, context.customizations);\n\n              // tslint:disable-next-line:no-any\n              const componentProps = this.props as any;\n\n              // If defaultProps.styles is a function, evaluate it before calling concatStyleSets\n              if (defaultProps.styles && typeof defaultProps.styles === 'function') {\n                defaultProps.styles = defaultProps.styles({ ...defaultProps, ...componentProps });\n              }\n\n              // If concatStyles is true and custom styles have been defined compute those styles\n              if (concatStyles && (defaultProps.styles || componentProps.styles)) {\n                const mergedStyles = concatStyleSets(defaultProps.styles, componentProps.styles);\n                return <ComposedComponent {...defaultProps} {...componentProps} styles={mergedStyles} />;\n              }\n\n              return <ComposedComponent {...defaultProps} {...componentProps} />;\n            }}\n          </CustomizerContext.Consumer>\n        );\n      }\n\n      private _onSettingChanged(): void {\n        this.forceUpdate();\n      }\n    };\n\n    return hoistStatics(ComposedComponent, resultClass);\n  };\n}\n"]}