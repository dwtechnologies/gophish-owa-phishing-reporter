{"version":3,"file":"initializeFocusRects.js","sourceRoot":"../src/","sources":["initializeFocusRects.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAC;AAC5C,OAAO,EAAE,oBAAoB,EAAE,MAAM,YAAY,CAAC;AAElD,MAAM,CAAC,IAAM,uBAAuB,GAAG,2BAA2B,CAAC;AAEnE;;;;;;;;;;;;;GAaG;AACH,MAAM,UAAU,oBAAoB,CAAC,MAAe;IAClD,IAAM,GAAG,GAAG,CAAC,MAAM,IAAI,SAAS,EAAE,CAAsD,CAAC;IAEzF,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,2BAA2B,EAAE;QAC3C,GAAG,CAAC,2BAA2B,GAAG,IAAI,CAAC;QACvC,GAAG,CAAC,gBAAgB,CAAC,WAAW,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;QACtD,GAAG,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAwB,EAAE,IAAI,CAAC,CAAC;KACjE;AACH,CAAC;AAED,SAAS,YAAY,CAAC,EAAc;IAClC,IAAM,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC,MAAiB,CAAC,CAAC;IAE5C,IAAI,GAAG,EAAE;QACC,IAAA,uCAAS,CAAuB;QAExC,IAAI,SAAS,CAAC,QAAQ,CAAC,uBAAuB,CAAC,EAAE;YAC/C,SAAS,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;SAC3C;KACF;AACH,CAAC;AAED,SAAS,UAAU,CAAC,EAAiB;IACnC,IAAM,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC,MAAiB,CAAC,CAAC;IAE5C,IAAI,GAAG,EAAE;QACC,IAAA,uCAAS,CAAuB;QAExC,IAAI,oBAAoB,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,uBAAuB,CAAC,EAAE;YAClF,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;SACxC;KACF;AACH,CAAC","sourcesContent":["import { getWindow } from './dom/getWindow';\nimport { isDirectionalKeyCode } from './keyboard';\n\nexport const IsFocusVisibleClassName = 'ms-Fabric--isFocusVisible';\n\n/**\n * Initializes the logic which:\n *\n * 1. Subscribes keydown and mousedown events. (It will only do it once per window,\n *    so it's safe to call this method multiple times.)\n * 2. When the user presses directional keyboard keys, adds the 'ms-Fabric--isFocusVisible' classname\n *    to the document body.\n * 3. When the user clicks a mouse button, we remove the classname if it exists.\n *\n * This logic allows components on the page to conditionally render focus treatments only\n * if the global classname exists, which simplifies logic overall.\n *\n * @param window - the window used to add the event listeners\n */\nexport function initializeFocusRects(window?: Window): void {\n  const win = (window || getWindow()) as Window & { __hasInitializeFocusRects__: boolean };\n\n  if (win && !win.__hasInitializeFocusRects__) {\n    win.__hasInitializeFocusRects__ = true;\n    win.addEventListener('mousedown', _onMouseDown, true);\n    win.addEventListener('keydown', _onKeyDown as () => void, true);\n  }\n}\n\nfunction _onMouseDown(ev: MouseEvent): void {\n  const win = getWindow(ev.target as Element);\n\n  if (win) {\n    const { classList } = win.document.body;\n\n    if (classList.contains(IsFocusVisibleClassName)) {\n      classList.remove(IsFocusVisibleClassName);\n    }\n  }\n}\n\nfunction _onKeyDown(ev: KeyboardEvent): void {\n  const win = getWindow(ev.target as Element);\n\n  if (win) {\n    const { classList } = win.document.body;\n\n    if (isDirectionalKeyCode(ev.which) && !classList.contains(IsFocusVisibleClassName)) {\n      classList.add(IsFocusVisibleClassName);\n    }\n  }\n}\n"]}