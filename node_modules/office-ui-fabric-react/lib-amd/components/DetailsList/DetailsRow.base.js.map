{"version":3,"file":"DetailsRow.base.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsRow.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { initializeComponentRef, EventGroup, IDisposable, css, shallowCompare, getNativeProps, divProperties } from '../../Utilities';\nimport { IColumn, CheckboxVisibility } from './DetailsList.types';\nimport { DetailsRowCheck } from './DetailsRowCheck';\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\nimport { DetailsRowFields } from './DetailsRowFields';\nimport { FocusZone, FocusZoneDirection, IFocusZone } from '../../FocusZone';\nimport { SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\nimport { CollapseAllVisibility } from '../../GroupedList';\nimport { IDragDropOptions } from './../../utilities/dragdrop/interfaces';\nimport { IDetailsRowBaseProps } from './DetailsRow.types';\nimport { IDetailsRowCheckProps } from './DetailsRowCheck.types';\nimport { IDetailsRowStyleProps, IDetailsRowStyles } from './DetailsRow.types';\nimport { classNamesFunction } from '../../Utilities';\nimport { IDetailsRowFieldsProps } from './DetailsRowFields.types';\nimport { IProcessedStyleSet } from '../../Styling';\n\nconst getClassNames = classNamesFunction<IDetailsRowStyleProps, IDetailsRowStyles>();\n\nexport interface IDetailsRowSelectionState {\n  isSelected: boolean;\n  isSelectionModal: boolean;\n}\n\nexport interface IDetailsRowState {\n  selectionState: IDetailsRowSelectionState;\n  columnMeasureInfo?: {\n    index: number;\n    column: IColumn;\n    onMeasureDone: (measuredWidth: number) => void;\n  };\n  isDropping?: boolean;\n}\n\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\n\nconst NO_COLUMNS: IColumn[] = [];\n\nexport class DetailsRowBase extends React.Component<IDetailsRowBaseProps, IDetailsRowState> {\n  private _events: EventGroup;\n  private _root: HTMLElement | undefined;\n  private _cellMeasurer = React.createRef<HTMLSpanElement>();\n  private _focusZone = React.createRef<IFocusZone>();\n  private _droppingClassNames: string;\n  /** Whether this.props.onDidMount has been called */\n  private _onDidMountCalled: boolean;\n  private _dragDropSubscription: IDisposable;\n\n  private _classNames: IProcessedStyleSet<IDetailsRowStyles>;\n  private _rowClassNames: IDetailsRowFieldsProps['rowClassNames'];\n\n  constructor(props: IDetailsRowBaseProps) {\n    super(props);\n\n    initializeComponentRef(this);\n    this._events = new EventGroup(this);\n\n    this.state = {\n      selectionState: this._getSelectionState(props),\n      columnMeasureInfo: undefined,\n      isDropping: false\n    };\n\n    this._droppingClassNames = '';\n  }\n\n  public componentDidMount(): void {\n    const { dragDropHelper } = this.props;\n\n    if (dragDropHelper) {\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\n    }\n\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\n\n    if (this.props.onDidMount && this.props.item) {\n      // If the item appears later, we should wait for it before calling this method.\n      this._onDidMountCalled = true;\n      this.props.onDidMount(this);\n    }\n  }\n\n  public componentDidUpdate(previousProps: IDetailsRowBaseProps) {\n    const state = this.state;\n    const { item, onDidMount } = this.props;\n    const { columnMeasureInfo } = state;\n\n    if (\n      this.props.itemIndex !== previousProps.itemIndex ||\n      this.props.item !== previousProps.item ||\n      this.props.dragDropHelper !== previousProps.dragDropHelper\n    ) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(\n          this._root as HTMLElement,\n          this._events,\n          this._getRowDragDropOptions()\n        );\n      }\n    }\n\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0 && this._cellMeasurer.current) {\n      const newWidth = this._cellMeasurer.current.getBoundingClientRect().width;\n\n      columnMeasureInfo.onMeasureDone(newWidth);\n\n      this.setState({\n        columnMeasureInfo: undefined\n      });\n    }\n\n    if (item && onDidMount && !this._onDidMountCalled) {\n      this._onDidMountCalled = true;\n      onDidMount(this);\n    }\n  }\n\n  public componentWillUnmount(): void {\n    const { item, onWillUnmount } = this.props;\n\n    // Only call the onWillUnmount callback if we have an item.\n    if (onWillUnmount && item) {\n      onWillUnmount(this);\n    }\n\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n      delete this._dragDropSubscription;\n    }\n\n    this._events.dispose();\n  }\n\n  // tslint:disable-next-line function-name\n  public UNSAFE_componentWillReceiveProps(newProps: IDetailsRowBaseProps): void {\n    this.setState({\n      selectionState: this._getSelectionState(newProps)\n    });\n  }\n\n  public shouldComponentUpdate(nextProps: IDetailsRowBaseProps, nextState: IDetailsRowState): boolean {\n    if (this.props.useReducedRowRenderer) {\n      const newSelectionState = this._getSelectionState(nextProps);\n      if (this.state.selectionState.isSelected !== newSelectionState.isSelected) {\n        return true;\n      }\n      return !shallowCompare(this.props, nextProps);\n    } else {\n      return true;\n    }\n  }\n\n  public render(): JSX.Element {\n    const {\n      className,\n      columns = NO_COLUMNS,\n      dragDropEvents,\n      item,\n      itemIndex,\n      onRenderCheck = this._onRenderCheck,\n      onRenderDetailsCheckbox,\n      onRenderItemColumn,\n      getCellValueKey,\n      selectionMode,\n      rowWidth = 0,\n      checkboxVisibility,\n      getRowAriaLabel,\n      getRowAriaDescribedBy,\n      checkButtonAriaLabel,\n      checkboxCellClassName,\n      /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\n      rowFieldsAs: RowFields = DetailsRowFields,\n      selection,\n      indentWidth,\n      enableUpdateAnimations,\n      compact,\n      theme,\n      styles,\n      cellsByColumn,\n      groupNestingDepth,\n      useFastIcons = true\n    } = this.props;\n    const { columnMeasureInfo, isDropping } = this.state;\n    const { isSelected = false, isSelectionModal = false } = this.state.selectionState;\n    const isDraggable = dragDropEvents ? !!(dragDropEvents.canDrag && dragDropEvents.canDrag(item)) : undefined;\n    const droppingClassName = isDropping ? this._droppingClassNames || DEFAULT_DROPPING_CSS_CLASS : '';\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : undefined;\n    const ariaDescribedBy = getRowAriaDescribedBy ? getRowAriaDescribedBy(item) : undefined;\n    const canSelect = !!selection && selection.canSelectItem(item, itemIndex);\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\n    const showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\n    const ariaSelected = selectionMode === SelectionMode.none ? undefined : isSelected;\n\n    this._classNames = {\n      ...this._classNames,\n      ...getClassNames(styles, {\n        theme: theme!,\n        isSelected,\n        canSelect: !isContentUnselectable,\n        anySelected: isSelectionModal,\n        checkboxCellClassName,\n        droppingClassName,\n        className,\n        compact,\n        enableUpdateAnimations\n      })\n    };\n\n    const rowClassNames: IDetailsRowFieldsProps['rowClassNames'] = {\n      isMultiline: this._classNames.isMultiline,\n      isRowHeader: this._classNames.isRowHeader,\n      cell: this._classNames.cell,\n      cellAnimation: this._classNames.cellAnimation,\n      cellPadded: this._classNames.cellPadded,\n      cellUnpadded: this._classNames.cellUnpadded,\n      fields: this._classNames.fields\n    };\n\n    // Only re-assign rowClassNames when classNames have changed.\n    // Otherwise, they will cause DetailsRowFields to unnecessarily\n    // re-render, see https://github.com/OfficeDev/office-ui-fabric-react/pull/8799.\n    // Refactor DetailsRowFields to generate own styles to remove need for this.\n    if (!shallowCompare(this._rowClassNames || {}, rowClassNames)) {\n      this._rowClassNames = rowClassNames;\n    }\n\n    const rowFields = (\n      <RowFields\n        rowClassNames={this._rowClassNames}\n        cellsByColumn={cellsByColumn}\n        columns={columns}\n        item={item}\n        itemIndex={itemIndex}\n        columnStartIndex={showCheckbox ? 1 : 0}\n        onRenderItemColumn={onRenderItemColumn}\n        getCellValueKey={getCellValueKey}\n        enableUpdateAnimations={enableUpdateAnimations}\n      />\n    );\n\n    return (\n      <FocusZone\n        {...getNativeProps(this.props, divProperties)}\n        {...(typeof isDraggable === 'boolean'\n          ? {\n              'data-is-draggable': isDraggable, // This data attribute is used by some host applications.\n              draggable: isDraggable\n            }\n          : {})}\n        direction={FocusZoneDirection.horizontal}\n        ref={this._onRootRef}\n        componentRef={this._focusZone}\n        role=\"row\"\n        aria-label={ariaLabel}\n        aria-describedby={ariaDescribedBy}\n        className={this._classNames.root}\n        data-is-focusable={true}\n        data-selection-index={itemIndex}\n        data-item-index={itemIndex}\n        aria-rowindex={itemIndex + 1}\n        data-automationid=\"DetailsRow\"\n        style={{ minWidth: rowWidth }}\n        aria-selected={ariaSelected}\n        allowFocusRoot={true}\n      >\n        {showCheckbox && (\n          <div role=\"gridcell\" aria-colindex={1} data-selection-toggle={true} className={this._classNames.checkCell}>\n            {onRenderCheck({\n              selected: isSelected,\n              anySelected: isSelectionModal,\n              'aria-label': checkButtonAriaLabel,\n              canSelect,\n              compact,\n              className: this._classNames.check,\n              theme,\n              isVisible: checkboxVisibility === CheckboxVisibility.always,\n              onRenderDetailsCheckbox: onRenderDetailsCheckbox,\n              useFastIcons\n            })}\n          </div>\n        )}\n\n        <GroupSpacer\n          indentWidth={indentWidth}\n          count={groupNestingDepth! - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0)}\n        />\n\n        {item && rowFields}\n        {columnMeasureInfo && (\n          <span role=\"presentation\" className={css(this._classNames.cellMeasurer, this._classNames.cell)} ref={this._cellMeasurer}>\n            <RowFields\n              rowClassNames={this._rowClassNames}\n              columns={[columnMeasureInfo.column]}\n              item={item}\n              itemIndex={itemIndex}\n              columnStartIndex={(showCheckbox ? 1 : 0) + columns.length}\n              onRenderItemColumn={onRenderItemColumn}\n              getCellValueKey={getCellValueKey}\n            />\n          </span>\n        )}\n\n        <span role=\"checkbox\" className={this._classNames.checkCover} aria-checked={isSelected} data-selection-toggle={true} />\n      </FocusZone>\n    );\n  }\n\n  /**\n   * measure cell at index. and call the call back with the measured cell width when finish measure\n   *\n   * @param index - The cell index\n   * @param onMeasureDone - The call back function when finish measure\n   */\n  public measureCell(index: number, onMeasureDone: (width: number) => void): void {\n    const { columns = NO_COLUMNS } = this.props;\n    const column: IColumn = { ...columns[index] };\n\n    column.minWidth = 0;\n    column.maxWidth = 999999;\n\n    delete column.calculatedWidth;\n\n    this.setState({\n      columnMeasureInfo: {\n        index,\n        column,\n        onMeasureDone\n      }\n    });\n  }\n\n  public focus(forceIntoFirstElement: boolean = false): boolean {\n    return !!this._focusZone.current && this._focusZone.current.focus(forceIntoFirstElement);\n  }\n\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\n    return <DetailsRowCheck {...props} />;\n  }\n\n  private _getSelectionState(props: IDetailsRowBaseProps): IDetailsRowSelectionState {\n    const { itemIndex, selection } = props;\n\n    return {\n      isSelected: !!selection && selection.isIndexSelected(itemIndex),\n      isSelectionModal: !!selection && !!selection.isModal && selection.isModal()\n    };\n  }\n\n  private _onSelectionChanged = (): void => {\n    const selectionState = this._getSelectionState(this.props);\n\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\n      this.setState({\n        selectionState: selectionState\n      });\n    }\n  };\n\n  private _onRootRef = (focusZone: FocusZone): void => {\n    if (focusZone) {\n      // Need to resolve the actual DOM node, not the component. The element itself will be used for drag/drop and focusing.\n      this._root = ReactDOM.findDOMNode(focusZone) as HTMLElement;\n    } else {\n      this._root = undefined;\n    }\n  };\n\n  private _getRowDragDropOptions(): IDragDropOptions {\n    const { item, itemIndex, dragDropEvents, eventsToRegister } = this.props;\n    const options = {\n      eventMap: eventsToRegister,\n      selectionIndex: itemIndex,\n      context: { data: item, index: itemIndex },\n      canDrag: dragDropEvents!.canDrag,\n      canDrop: dragDropEvents!.canDrop,\n      onDragStart: dragDropEvents!.onDragStart,\n      updateDropState: this._updateDroppingState,\n      onDrop: dragDropEvents!.onDrop,\n      onDragEnd: dragDropEvents!.onDragEnd\n    };\n\n    return options;\n  }\n\n  /**\n   * update isDropping state based on the input value, which is used to change style during drag and drop\n   *\n   * when change to true, that means drag enter. we will add default dropping class name\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n   *\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\n   *\n   * @param newValue - New isDropping state value\n   * @param event - The event trigger dropping state change which can be dragenter, dragleave etc\n   */\n  private _updateDroppingState = (newValue: boolean, event: DragEvent): void => {\n    const { isDropping } = this.state;\n    const { dragDropEvents, item } = this.props;\n\n    if (!newValue) {\n      if (dragDropEvents!.onDragLeave) {\n        dragDropEvents!.onDragLeave(item, event);\n      }\n    } else if (dragDropEvents!.onDragEnter) {\n      this._droppingClassNames = dragDropEvents!.onDragEnter(item, event);\n    }\n\n    if (isDropping !== newValue) {\n      this.setState({ isDropping: newValue });\n    }\n  };\n}\n"]}