{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { BaseComponent } from 'office-ui-fabric-react/lib/Utilities';\nimport { CommandBarButton } from 'office-ui-fabric-react/lib/Button';\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\nimport { OverflowSet } from 'office-ui-fabric-react/lib/OverflowSet';\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\n\nimport * as stylesImport from './ResizeGroup.Example.scss';\nconst styles: any = stylesImport;\n\nexport interface IOverflowData {\n  primary: IContextualMenuItem[];\n  overflow: IContextualMenuItem[];\n  cacheKey?: string;\n}\n\nfunction generateData(count: number, cachingEnabled: boolean, checked: boolean): IOverflowData {\n  const icons = ['Add', 'Share', 'Upload'];\n  const dataItems = [];\n  let cacheKey = '';\n  for (let index = 0; index < count; index++) {\n    const item = {\n      key: `item${index}`,\n      name: `Item ${index}`,\n      icon: icons[index % icons.length],\n      checked: checked\n    };\n\n    cacheKey = cacheKey + item.key;\n    dataItems.push(item);\n  }\n\n  let result: IOverflowData = {\n    primary: dataItems,\n    overflow: [] as any[]\n  };\n\n  if (cachingEnabled) {\n    result = { ...result, cacheKey };\n  }\n\n  return result;\n}\n\nexport interface IResizeGroupOverflowSetExampleState {\n  short: boolean;\n  numberOfItems: number;\n  buttonsChecked: boolean;\n  cachingEnabled: boolean;\n  onGrowDataEnabled: boolean;\n}\n\nfunction computeCacheKey(primaryControls: IContextualMenuItem[]): string {\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\n}\n\nexport class ResizeGroupOverflowSetExample extends BaseComponent<{}, IResizeGroupOverflowSetExampleState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      short: false,\n      buttonsChecked: false,\n      cachingEnabled: false,\n      onGrowDataEnabled: false,\n      numberOfItems: 20\n    };\n  }\n\n  public render(): JSX.Element {\n    const { numberOfItems, cachingEnabled, buttonsChecked, short, onGrowDataEnabled } = this.state;\n    const dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\n    return (\n      <div className={short ? styles.resizeIsShort : 'notResized'}>\n        <ResizeGroup\n          role=\"tabpanel\"\n          aria-label=\"Resize Group with an Overflow Set\"\n          data={dataToRender}\n          onReduceData={this._onReduceData}\n          onGrowData={onGrowDataEnabled ? this._onGrowData : undefined}\n          // tslint:disable-next-line:jsx-no-lambda\n          onRenderData={data => {\n            return (\n              <OverflowSet\n                items={data.primary}\n                overflowItems={data.overflow.length ? data.overflow : null}\n                onRenderItem={item => {\n                  return (\n                    <CommandBarButton text={item.name} iconProps={{ iconName: item.icon }} onClick={item.onClick} checked={item.checked} />\n                  );\n                }}\n                onRenderOverflowButton={overflowItems => {\n                  return <CommandBarButton menuProps={{ items: overflowItems! }} />;\n                }}\n                styles={{ root: { height: 40 } }}\n              />\n            );\n          }}\n        />\n        <div className={styles.settingsGroup}>\n          <Checkbox label=\"Enable caching\" onChange={this._onCachingEnabledChanged} checked={cachingEnabled} />\n          <Checkbox label=\"Set onGrowData\" onChange={this._onGrowDataEnabledChanged} checked={onGrowDataEnabled} />\n          <Checkbox label=\"Buttons checked\" onChange={this._onButtonsCheckedChanged} checked={buttonsChecked} />\n          <div className={styles.itemCountDropdown}>\n            <Dropdown\n              label=\"Number of items to render\"\n              selectedKey={numberOfItems.toString()}\n              onChange={this._onNumberOfItemsChanged}\n              options={[\n                { key: '20', text: '20' },\n                { key: '30', text: '30' },\n                { key: '40', text: '40' },\n                { key: '50', text: '50' },\n                { key: '75', text: '75' },\n                { key: '100', text: '100' },\n                { key: '200', text: '200' }\n              ]}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  private _onReduceData = (currentData: any): any => {\n    if (currentData.primary.length === 0) {\n      return undefined;\n    }\n\n    const overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\n    const primary = currentData.primary.slice(0, -1);\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  };\n\n  private _onGrowData = (currentData: any): any => {\n    if (currentData.overflow.length === 0) {\n      return undefined;\n    }\n\n    const overflow = currentData.overflow.slice(1);\n    const primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  };\n\n  private _onCachingEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ cachingEnabled: checked });\n  };\n\n  private _onGrowDataEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ onGrowDataEnabled: checked });\n  };\n\n  private _onButtonsCheckedChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ buttonsChecked: checked });\n  };\n\n  private _onNumberOfItemsChanged = (event: React.FormEvent<HTMLDivElement>, option: IDropdownOption): void => {\n    this.setState({ numberOfItems: parseInt(option.text, 10) });\n  };\n}\n"]}