{"version":3,"file":"ComboBox.Controlled.Example.js","sourceRoot":"../src/","sources":["components/ComboBox/examples/ComboBox.Controlled.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { ComboBox, IComboBoxOption, IComboBox, SelectableOptionMenuItemType, Fabric, mergeStyles } from 'office-ui-fabric-react/lib/index';\n\nconst INITIAL_OPTIONS: IComboBoxOption[] = [\n  { key: 'Header1', text: 'First heading', itemType: SelectableOptionMenuItemType.Header },\n  { key: 'A', text: 'Option A' },\n  { key: 'B', text: 'Option B' },\n  { key: 'C', text: 'Option C' },\n  { key: 'D', text: 'Option D' },\n  { key: 'divider', text: '-', itemType: SelectableOptionMenuItemType.Divider },\n  { key: 'Header2', text: 'Second heading', itemType: SelectableOptionMenuItemType.Header },\n  { key: 'E', text: 'Option E' },\n  { key: 'F', text: 'Option F', disabled: true },\n  { key: 'G', text: 'Option G' },\n  { key: 'H', text: 'Option H' },\n  { key: 'I', text: 'Option I' },\n  { key: 'J', text: 'Option J' }\n];\n\nconst wrapperClassName = mergeStyles({\n  selectors: {\n    '& > *': { marginBottom: '20px' },\n    '& .ms-ComboBox': { maxWidth: '300px' }\n  }\n});\n\nexport interface IComboBoxControlledExampleState {\n  /** Current options for the single-select example */\n  options: IComboBoxOption[];\n  /** Current selected option for the single-select example */\n  selectedOptionKey?: string | number;\n  /**\n   * Initial display value for the single-select example.\n   * This will be cleared after the options are resolved for the first time.\n   */\n  initialDisplayValue?: string;\n\n  /** Current options for the multi-select example */\n  optionsMulti: IComboBoxOption[];\n  /** Current selected options for the multi-select example */\n  selectedOptionKeys?: string[];\n  /**\n   * Initial display value for the multi-select example.\n   * This will be cleared after the options are resolved for the first time.\n   */\n  initialDisplayValueMulti?: string;\n}\n\n// tslint:disable:jsx-no-lambda\nexport class ComboBoxControlledExample extends React.Component<{}, IComboBoxControlledExampleState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      // The options will be resolved (and updated in state) the first time each example is focused\n      options: [],\n      optionsMulti: [],\n      // This is the text of the option which will be initially selected after the options are resolved\n      initialDisplayValue: 'Option C',\n      initialDisplayValueMulti: 'Option C, Option D'\n    };\n  }\n\n  public render(): JSX.Element {\n    const state = this.state;\n\n    return (\n      <Fabric className={wrapperClassName}>\n        <ComboBox\n          selectedKey={state.selectedOptionKey}\n          label=\"Controlled single-select ComboBox (allowFreeform: T)\"\n          allowFreeform={true}\n          autoComplete=\"on\"\n          options={state.options}\n          onChange={this._onChange}\n          onResolveOptions={this._getOptions}\n          text={state.initialDisplayValue}\n        />\n\n        <ComboBox\n          multiSelect\n          selectedKey={state.selectedOptionKeys}\n          label=\"Controlled multi-select ComboBox (allowFreeform: T)\"\n          allowFreeform={true}\n          autoComplete=\"on\"\n          options={state.optionsMulti}\n          onChange={this._onChangeMulti}\n          onResolveOptions={this._getOptionsMulti}\n          text={state.initialDisplayValueMulti}\n        />\n      </Fabric>\n    );\n  }\n\n  private _getOptions = (currentOptions: IComboBoxOption[]): IComboBoxOption[] => {\n    if (this.state.options.length > 0) {\n      return this.state.options;\n    }\n\n    const options = [...INITIAL_OPTIONS];\n\n    this.setState({\n      options: options,\n      selectedOptionKey: 'C',\n      initialDisplayValue: undefined\n    });\n\n    return options;\n  };\n\n  private _getOptionsMulti = (currentOptions: IComboBoxOption[]): IComboBoxOption[] => {\n    if (this.state.optionsMulti.length > 0) {\n      return this.state.optionsMulti;\n    }\n\n    const options = [...INITIAL_OPTIONS];\n\n    this.setState({\n      optionsMulti: options,\n      selectedOptionKeys: ['C', 'D'],\n      initialDisplayValueMulti: undefined\n    });\n\n    return options;\n  };\n\n  private _onChange = (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string): void => {\n    console.log('_onChanged() is called: option = ' + JSON.stringify(option));\n    if (option) {\n      // User chose an existing option\n      this.setState({\n        selectedOptionKey: option.key\n      });\n    } else if (value !== undefined) {\n      // User typed a new option\n      const newOption: IComboBoxOption = { key: value, text: value };\n\n      this.setState({\n        options: [...this.state.options, newOption],\n        selectedOptionKey: newOption.key\n      });\n    }\n  };\n\n  private _onChangeMulti = (event: React.FormEvent<IComboBox>, option?: IComboBoxOption, index?: number, value?: string) => {\n    console.log('_onChangeMulti() is called: option = ' + JSON.stringify(option));\n    const currentSelectedKeys = this.state.selectedOptionKeys || [];\n    if (option) {\n      // User selected/de-selected an existing option\n      this.setState({\n        selectedOptionKeys: this._updateSelectedOptionKeys(currentSelectedKeys, option)\n      });\n    } else if (value !== undefined) {\n      // User typed a freeform option\n      const newOption: IComboBoxOption = { key: value, text: value };\n      const updatedSelectedKeys: string[] = [...currentSelectedKeys, newOption.key as string];\n      this.setState({\n        optionsMulti: [...this.state.optionsMulti, newOption],\n        selectedOptionKeys: updatedSelectedKeys\n      });\n    }\n  };\n\n  private _updateSelectedOptionKeys = (selectedKeys: string[], option: IComboBoxOption): string[] => {\n    selectedKeys = [...selectedKeys]; // modify a copy\n    const index = selectedKeys.indexOf(option.key as string);\n    if (option.selected && index < 0) {\n      selectedKeys.push(option.key as string);\n    } else {\n      selectedKeys.splice(index, 1);\n    }\n    return selectedKeys;\n  };\n}\n"]}