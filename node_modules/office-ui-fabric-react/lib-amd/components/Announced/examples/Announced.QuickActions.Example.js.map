{"version":3,"file":"Announced.QuickActions.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.QuickActions.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  Selection,\n  IColumn,\n  IDetailsList,\n  IDetailsRowProps,\n  DetailsRow\n} from 'office-ui-fabric-react/lib/DetailsList';\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\nimport { IconButton, PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport { Dialog, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\nimport { TextField, ITextField } from 'office-ui-fabric-react/lib/TextField';\n\nconst _items: IAnnouncedQuickActionsExampleItem[] = [];\n\nconst _columns: IColumn[] = ['Name', 'Modified', 'Modified By', 'File Size'].map((name: string) => {\n  const fieldName = name.replace(' ', '').toLowerCase();\n  return {\n    fieldName,\n    name,\n    key: fieldName,\n    minWidth: 100,\n    maxWidth: 200,\n    isResizable: true\n  };\n});\n\nconst _names: string[] = [\n  'Annie Lindqvist',\n  'Aaron Reid',\n  'Alex Lundberg',\n  'Roko Kolar',\n  'Christian Bergqvist',\n  'Valentina Lovric',\n  'Makenzie Sharett'\n];\n\nfunction getMockDateString(): string {\n  return 'Thu Jan 05 2017â€Œ';\n}\n\nexport interface IAnnouncedQuickActionsExampleItem {\n  key: number;\n  name: string;\n  modified: string;\n  modifiedby: string;\n  filesize: string;\n}\n\nexport interface IAnnouncedQuickActionsExampleState {\n  items: IAnnouncedQuickActionsExampleItem[];\n  selectionDetails: {};\n  renameDialogOpen: boolean;\n  dialogContent: JSX.Element | undefined;\n  announced?: JSX.Element;\n}\n\nexport class AnnouncedQuickActionsExample extends React.Component<{}, IAnnouncedQuickActionsExampleState> {\n  private _selection: Selection;\n  private _detailsList = React.createRef<IDetailsList>();\n  private _textField = React.createRef<ITextField>();\n  private _async: Async;\n\n  constructor(props: {}) {\n    super(props);\n\n    this._async = new Async(this);\n\n    // Populate with items for demos.\n    if (_items.length === 0) {\n      for (let i = 0; i < 20; i++) {\n        _items.push({\n          key: i,\n          name: 'Item ' + i,\n          modified: getMockDateString(),\n          modifiedby: _names[Math.floor(Math.random() * _names.length)],\n          filesize: Math.floor(Math.random() * 30).toString() + ' MB'\n        });\n      }\n    }\n\n    this._selection = new Selection({\n      onSelectionChanged: () => this.setState({ selectionDetails: this._getSelectionDetails() })\n    });\n\n    this.state = {\n      items: _items,\n      selectionDetails: this._getSelectionDetails(),\n      renameDialogOpen: false,\n      dialogContent: undefined,\n      announced: undefined\n    };\n  }\n\n  public componentDidUpdate(prevState: IAnnouncedQuickActionsExampleState) {\n    if (prevState.announced !== this.state.announced && this.state.announced !== undefined) {\n      this._async.setTimeout(() => {\n        this.setState({\n          announced: undefined\n        });\n      }, 2000);\n    }\n  }\n\n  public componentWillUnmount(): void {\n    this._async.dispose();\n  }\n\n  public render(): JSX.Element {\n    const { items, renameDialogOpen, dialogContent } = this.state;\n\n    return (\n      <>\n        {this._renderAnnounced()}\n        <MarqueeSelection selection={this._selection}>\n          <DetailsList\n            componentRef={this._detailsList}\n            items={items}\n            columns={_columns}\n            setKey=\"set\"\n            layoutMode={DetailsListLayoutMode.fixedColumns}\n            selection={this._selection}\n            selectionPreservedOnEmptyClick={true}\n            ariaLabelForSelectionColumn=\"Toggle selection\"\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n            onRenderItemColumn={this._onRenderItemColumn}\n            onRenderRow={this._onRenderRow}\n          />\n          <Dialog hidden={!renameDialogOpen} onDismiss={this._closeRenameDialog} closeButtonAriaLabel=\"Close\">\n            {dialogContent}\n          </Dialog>\n        </MarqueeSelection>\n      </>\n    );\n  }\n\n  private _onRenderRow = (props: IDetailsRowProps): JSX.Element => {\n    return <DetailsRow {...props} />;\n  };\n\n  private _onRenderItemColumn = (item: IAnnouncedQuickActionsExampleItem, index: number, column: IColumn) => {\n    const fieldContent = item[column.fieldName as keyof IAnnouncedQuickActionsExampleItem];\n\n    if (column.key === 'name') {\n      return (\n        <div>\n          {fieldContent}\n          <IconButton\n            menuIconProps={{ iconName: 'MoreVertical' }}\n            role=\"button\"\n            aria-haspopup={true}\n            aria-label=\"Show actions\"\n            styles={{ root: { float: 'right', height: 'inherit' } }}\n            menuProps={{\n              items: [\n                {\n                  key: 'delete',\n                  text: 'Delete',\n                  onClick: () => this._deleteItem(index)\n                },\n                {\n                  key: 'rename',\n                  text: 'Rename',\n                  onClick: () => this._renameItem(item, index)\n                }\n              ]\n            }}\n          />\n        </div>\n      );\n    } else {\n      return <span>{fieldContent}</span>;\n    }\n  };\n\n  private _renderAnnounced = (): JSX.Element | undefined => {\n    const { announced } = this.state;\n    return announced;\n  };\n\n  private _deleteItem = (index: number): void => {\n    const items = this.state.items;\n    items.splice(items.indexOf(items[index]), 1);\n\n    this.setState({\n      items: [...items],\n      announced: <Announced message=\"Item deleted\" aria-live=\"assertive\" />\n    });\n    return;\n  };\n\n  private _renameItem(item: IAnnouncedQuickActionsExampleItem, index: number): void {\n    this.setState({\n      renameDialogOpen: true,\n      dialogContent: (\n        <>\n          <TextField componentRef={this._textField} label=\"Rename\" defaultValue={item.name} />\n          <DialogFooter>\n            <PrimaryButton onClick={this._updateItemName.bind(this, index)} text=\"Save\" />\n          </DialogFooter>\n        </>\n      )\n    });\n    return;\n  }\n\n  private _updateItemName(index: number): void {\n    if (this._textField && this._textField.current) {\n      const items = this.state.items;\n      items[index].name = this._textField.current.value || items[index].name;\n      this.setState({\n        renameDialogOpen: false,\n        items: [...items],\n        announced: <Announced message=\"Item renamed\" aria-live=\"assertive\" />\n      });\n    } else {\n      return;\n    }\n  }\n\n  private _closeRenameDialog = (): void => {\n    this.setState({\n      renameDialogOpen: false\n    });\n  };\n\n  private _getSelectionDetails(): string {\n    const selectionCount = this._selection.getSelectedCount();\n\n    switch (selectionCount) {\n      case 0:\n        return 'No items selected';\n      case 1:\n        return '1 item selected: ' + (this._selection.getSelection()[0] as any).name;\n      default:\n        return `${selectionCount} items selected`;\n    }\n  }\n}\n"]}