{"version":3,"file":"ExtendedPeoplePicker.Controlled.Example.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/examples/ExtendedPeoplePicker.Controlled.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\nimport { ExtendedPeoplePicker } from 'office-ui-fabric-react/lib/ExtendedPicker';\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport {\n  SuggestionsStore,\n  FloatingPeoplePicker,\n  IBaseFloatingPickerProps,\n  IBaseFloatingPickerSuggestionProps\n} from 'office-ui-fabric-react/lib/FloatingPicker';\nimport { ISelectedPeopleProps, SelectedPeopleList, IExtendedPersonaProps } from 'office-ui-fabric-react/lib/SelectedItemsList';\nimport { IFocusZoneProps, FocusZoneTabbableElements } from 'office-ui-fabric-react/lib/FocusZone';\nimport { mergeStyleSets, getTheme, IStyle, IProcessedStyleSet } from 'office-ui-fabric-react/lib/Styling';\nimport { people, mru, groupOne, groupTwo } from '@uifabric/example-data';\n\nexport interface IPeoplePickerExampleState {\n  peopleList: IPersonaProps[];\n  mostRecentlyUsed: IPersonaProps[];\n  searchMoreAvailable: boolean;\n  currentlySelectedItems: IExtendedPersonaProps[];\n  suggestionItems: IPersonaProps[];\n}\n\ninterface IClassNames {\n  picker: IStyle;\n  headerItem: IStyle;\n  footerItem: IStyle;\n  to: IStyle;\n}\n\nexport class ExtendedPeoplePickerControlledExample extends React.Component<{}, IPeoplePickerExampleState> {\n  private _picker = React.createRef<ExtendedPeoplePicker>();\n  private _floatingPickerProps: IBaseFloatingPickerProps<IPersonaProps>;\n  private _selectedItemsListProps: ISelectedPeopleProps;\n  private _focusZoneProps: IFocusZoneProps;\n  private _suggestionProps: IBaseFloatingPickerSuggestionProps;\n  private _classNames: IProcessedStyleSet<IClassNames>;\n\n  constructor(props: {}) {\n    super(props);\n\n    this.state = {\n      peopleList: people,\n      mostRecentlyUsed: mru,\n      searchMoreAvailable: true,\n      currentlySelectedItems: [],\n      suggestionItems: []\n    };\n\n    this._suggestionProps = {\n      showRemoveButtons: true,\n      headerItemsProps: [\n        {\n          renderItem: () => {\n            const picker = this._picker.current;\n            return (\n              <div className={this._classNames.headerItem}>\n                Use this address: {picker && picker.inputElement ? picker.inputElement.value : ''}\n              </div>\n            );\n          },\n          shouldShow: () => {\n            const picker = this._picker.current;\n            return !!(picker && picker.inputElement) && picker.inputElement.value.indexOf('@') > -1;\n          },\n          onExecute: () => {\n            const picker = this._picker.current;\n            const floatingPicker = picker && picker.floatingPicker.current;\n            if (floatingPicker) {\n              floatingPicker.forceResolveSuggestion();\n            }\n          },\n          ariaLabel: 'Use the typed address'\n        },\n        {\n          renderItem: () => {\n            return <div className={this._classNames.headerItem}>Suggested Contacts</div>;\n          },\n          shouldShow: this._shouldShowSuggestedContacts\n        }\n      ],\n      footerItemsProps: [\n        {\n          renderItem: () => {\n            return <div className={this._classNames.footerItem}>No results</div>;\n          },\n          shouldShow: () => {\n            const picker = this._picker.current;\n            const floatingPicker = picker && picker.floatingPicker.current;\n            return !!floatingPicker && floatingPicker.suggestions.length === 0;\n          }\n        },\n        {\n          renderItem: () => {\n            return <div className={this._classNames.footerItem}>Search for more</div>;\n          },\n          onExecute: () => {\n            this.setState({ searchMoreAvailable: false });\n          },\n          shouldShow: () => {\n            return this.state.searchMoreAvailable && !this._shouldShowSuggestedContacts();\n          },\n          ariaLabel: 'Search more'\n        }\n      ],\n      shouldSelectFirstItem: () => {\n        return !this._shouldShowSuggestedContacts();\n      }\n    };\n\n    this._floatingPickerProps = {\n      suggestionsStore: new SuggestionsStore<IPersonaProps>(),\n      onResolveSuggestions: this._onFilterChanged,\n      getTextFromItem: (persona: IPersonaProps) => persona.text || '',\n      pickerSuggestionsProps: this._suggestionProps,\n      key: 'normal',\n      onRemoveSuggestion: this._onRemoveSuggestion,\n      onValidateInput: this._validateInput,\n      onZeroQuerySuggestion: this._returnMostRecentlyUsed,\n      showForceResolve: this._shouldShowForceResolve,\n      onInputChanged: this._onInputChanged,\n      onSuggestionsHidden: () => {\n        console.log('FLOATINGPICKER: hidden');\n      },\n      onSuggestionsShown: () => {\n        console.log('FLOATINGPICKER: shown');\n      }\n    };\n\n    this._selectedItemsListProps = {\n      onCopyItems: this._onCopyItems,\n      onExpandGroup: this._onExpandItem,\n      removeMenuItemText: 'Remove',\n      copyMenuItemText: 'Copy name',\n      editMenuItemText: 'Edit',\n      getEditingItemText: this._getEditingItemText,\n      onRenderFloatingPicker: FloatingPeoplePicker,\n      floatingPickerProps: this._floatingPickerProps\n    };\n\n    this._focusZoneProps = {\n      shouldInputLoseFocusOnArrowKey: () => true,\n      handleTabKey: FocusZoneTabbableElements.all\n    };\n  }\n\n  public render(): JSX.Element {\n    const theme = getTheme();\n    this._classNames = mergeStyleSets({\n      picker: { maxWidth: 400, marginBottom: 15 },\n      headerItem: {\n        borderBottom: '1px solid ' + theme.palette.neutralLight,\n        padding: '8px 12px'\n      },\n      footerItem: {\n        borderBottom: '1px solid ' + theme.palette.neutralLight,\n        height: 60,\n        paddingLeft: 12\n      },\n      to: { padding: '0 10px' }\n    });\n\n    return (\n      <div>\n        {this._renderExtendedPicker()}\n        <PrimaryButton text=\"Set focus\" onClick={this._onSetFocusButtonClicked} />\n      </div>\n    );\n  }\n\n  private _renderExtendedPicker(): JSX.Element {\n    return (\n      <ExtendedPeoplePicker\n        selectedItems={this.state.currentlySelectedItems}\n        suggestionItems={this.state.suggestionItems}\n        onItemAdded={this._onItemAdded}\n        onItemsRemoved={this._onItemsRemoved}\n        floatingPickerProps={this._floatingPickerProps}\n        selectedItemsListProps={this._selectedItemsListProps}\n        onRenderFloatingPicker={FloatingPeoplePicker}\n        onRenderSelectedItems={SelectedPeopleList}\n        className={this._classNames.picker}\n        key=\"normal\"\n        inputProps={{\n          onBlur: () => console.log('onBlur called'),\n          onFocus: () => console.log('onFocus called'),\n          'aria-label': 'People Picker'\n        }}\n        componentRef={this._picker}\n        headerComponent={this._renderHeader()}\n        focusZoneProps={this._focusZoneProps}\n      />\n    );\n  }\n\n  private _renderHeader(): JSX.Element {\n    return (\n      <div className={this._classNames.to} data-is-focusable={true}>\n        To:\n      </div>\n    );\n  }\n\n  private _getEditingItemText = (item: IExtendedPersonaProps): string => {\n    return item.text || '';\n  };\n\n  private _onSetFocusButtonClicked = (): void => {\n    if (this._picker.current) {\n      this._picker.current.focus();\n    }\n  };\n\n  private _onExpandItem = (item: IExtendedPersonaProps): void => {\n    const { currentlySelectedItems } = this.state;\n    const indexToRemove = currentlySelectedItems.indexOf(item);\n    const newItems = currentlySelectedItems;\n    newItems.splice(indexToRemove, 1, ...this._getExpandedGroupItems(item));\n    this.setState({ currentlySelectedItems: newItems });\n  };\n\n  private _onRemoveSuggestion = (item: IPersonaProps): void => {\n    const { peopleList, mostRecentlyUsed: mruState } = this.state;\n    const itemIndex = peopleList.indexOf(item);\n    const itemMruIndex = mruState.indexOf(item);\n\n    const stateUpdate = {} as IPeoplePickerExampleState;\n    if (itemIndex >= 0) {\n      stateUpdate.peopleList = peopleList.slice(0, itemIndex).concat(peopleList.slice(itemIndex + 1));\n    }\n    if (itemMruIndex >= 0) {\n      stateUpdate.mostRecentlyUsed = mruState.slice(0, itemMruIndex).concat(mruState.slice(itemMruIndex + 1));\n    }\n    this.setState(stateUpdate);\n  };\n\n  private _onFilterChanged = (filterText: string, currentPersonas?: IPersonaProps[]): Promise<IPersonaProps[]> | null => {\n    let filteredPersonas: IPersonaProps[] = [];\n    if (filterText) {\n      filteredPersonas = this.state.peopleList.filter((item: IPersonaProps) => _startsWith(item.text || '', filterText));\n      filteredPersonas = this._removeDuplicates(filteredPersonas, currentPersonas);\n    }\n\n    this.setState({ suggestionItems: filteredPersonas });\n    return null;\n  };\n\n  private _returnMostRecentlyUsed = (): IPersonaProps[] | Promise<IPersonaProps[]> | null => {\n    let { mostRecentlyUsed } = this.state;\n    const items = (this._picker.current && this._picker.current.items) || [];\n    mostRecentlyUsed = this._removeDuplicates(mostRecentlyUsed, items);\n    this.setState({ suggestionItems: mostRecentlyUsed });\n    return null;\n  };\n\n  private _onCopyItems(items: IExtendedPersonaProps[]): string {\n    return items.map(item => item.text).join(', ');\n  }\n\n  private _shouldShowForceResolve = (): boolean => {\n    const picker = this._picker.current;\n    const floatingPicker = picker && picker.floatingPicker.current;\n    return !!floatingPicker && this._validateInput(floatingPicker.inputText) && floatingPicker.suggestions.length === 0;\n  };\n\n  private _shouldShowSuggestedContacts = (): boolean => {\n    const picker = this._picker.current;\n    return !!(picker && picker.inputElement) && picker.inputElement.value === '';\n  };\n\n  private _listContainsPersona(persona: IPersonaProps, personas?: IPersonaProps[]): boolean {\n    return !!personas && personas.some((item: IPersonaProps) => item.text === persona.text);\n  }\n\n  private _removeDuplicates(personas: IPersonaProps[], possibleDupes?: IPersonaProps[]): IPersonaProps[] {\n    return personas.filter((persona: IPersonaProps) => !this._listContainsPersona(persona, possibleDupes));\n  }\n\n  private _onInputChanged = (): void => {\n    this.setState({ searchMoreAvailable: true });\n  };\n\n  private _onItemAdded = (selectedSuggestion: IExtendedPersonaProps) => {\n    this.setState({ currentlySelectedItems: this.state.currentlySelectedItems.concat(selectedSuggestion) });\n  };\n\n  private _onItemsRemoved = (items: IExtendedPersonaProps[]): void => {\n    const newItems = this.state.currentlySelectedItems.filter(value => items.indexOf(value) === -1);\n    this.setState({ currentlySelectedItems: newItems });\n  };\n\n  private _validateInput = (input: string): boolean => {\n    return input.indexOf('@') !== -1;\n  };\n\n  private _getExpandedGroupItems(item: IExtendedPersonaProps): IExtendedPersonaProps[] {\n    return item.text === 'Group One' ? groupOne : item.text === 'Group Two' ? groupTwo : [];\n  }\n}\n\nfunction _startsWith(text: string, filterText: string): boolean {\n  return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\n}\n"]}