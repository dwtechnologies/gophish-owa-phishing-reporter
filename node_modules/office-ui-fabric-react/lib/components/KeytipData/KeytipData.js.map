{"version":3,"file":"KeytipData.js","sourceRoot":"../src/","sources":["components/KeytipData/KeytipData.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,EAAoB,wBAAwB,EAAE,MAAM,iBAAiB,CAAC;AAG7E,OAAO,EAAE,aAAa,EAAE,MAAM,uCAAuC,CAAC;AACtE,OAAO,EAAE,cAAc,EAAE,aAAa,EAAE,kBAAkB,EAAE,MAAM,qCAAqC,CAAC;AAExG;;;GAGG;AACH;IAAgC,sCAA4D;IAA5F;QAAA,qEAiEC;QA/DS,oBAAc,GAAkB,aAAa,CAAC,WAAW,EAAE,CAAC;;IA+DtE,CAAC;IA7DQ,sCAAiB,GAAxB;QACE,mCAAmC;QACnC,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;YAC1B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;SACpE;IACH,CAAC;IAEM,yCAAoB,GAA3B;QACE,qCAAqC;QACrC,IAAI,CAAC,KAAK,CAAC,WAAW,IAAI,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IAChG,CAAC;IAEM,uCAAkB,GAAzB,UAA0B,SAAkD;QAC1E,IAAI,SAAS,CAAC,WAAW,KAAK,IAAI,CAAC,KAAK,CAAC,WAAW,IAAI,SAAS,CAAC,QAAQ,KAAK,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;YAClG,wEAAwE;YACxE,IAAI,CAAC,KAAK,CAAC,WAAW,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;SAC3F;IACH,CAAC;IAEM,2BAAM,GAAb;QACQ,IAAA,eAAuD,EAArD,sBAAQ,EAAE,4BAAW,EAAE,oCAA8B,CAAC;QAC9D,IAAI,iBAAiB,GAAQ,EAAE,CAAC;QAChC,IAAI,WAAW,EAAE;YACf,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;SACrE;QACD,OAAO,QAAQ,CAAC,iBAAiB,CAAC,CAAC;IACrC,CAAC;IAEO,iCAAY,GAApB;QACE,0BACE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,IAC1B,IAAI,CAAC,KAAK,CAAC,WAAY,EAC1B;IACJ,CAAC;IAED;;;;OAIG;IACK,iCAAY,GAApB,UAAqB,WAAyB,EAAE,kBAA2B;QACzE,IAAI,WAAW,EAAE;YACf,gDAAgD;YAChD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;YAE1E,mEAAmE;YACnE,IAAM,eAAe,GAAG,kBAAkB,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;YACxE,IAAI,YAAY,GAAO,cAAc,CAAC,YAAY,QAAC,CAAC;YACpD,IAAI,cAAc,CAAC,mBAAmB,EAAE;gBACtC,YAAY,GAAG,cAAc,CAAC,YAAY,EAAE,cAAc,CAAC,mBAAmB,CAAC,CAAC;aACjF;YACD,IAAM,KAAK,GAAG,aAAa,CAAC,YAAY,CAAC,CAAC;YAE1C,OAAO;gBACL,kBAAkB,EAAE,wBAAwB,CAAC,kBAAkB,EAAE,eAAe,CAAC;gBACjF,iBAAiB,EAAE,KAAK;gBACxB,yBAAyB,EAAE,KAAK;aACjC,CAAC;SACH;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IACH,iBAAC;AAAD,CAAC,AAjED,CAAgC,KAAK,CAAC,SAAS,GAiE9C","sourcesContent":["import * as React from 'react';\nimport { IRenderComponent, mergeAriaAttributeValues } from '../../Utilities';\nimport { IKeytipDataProps } from './KeytipData.types';\nimport { IKeytipProps } from '../../Keytip';\nimport { KeytipManager } from '../../utilities/keytips/KeytipManager';\nimport { mergeOverflows, sequencesToID, getAriaDescribedBy } from '../../utilities/keytips/KeytipUtils';\n\n/**\n * A small element to help the target component correctly read out its aria-describedby for its Keytip\n * {@docCategory Keytips}\n */\nexport class KeytipData extends React.Component<IKeytipDataProps & IRenderComponent<{}>, {}> {\n  private _uniqueId: string;\n  private _keytipManager: KeytipManager = KeytipManager.getInstance();\n\n  public componentDidMount() {\n    // Register Keytip in KeytipManager\n    if (this.props.keytipProps) {\n      this._uniqueId = this._keytipManager.register(this._getKtpProps());\n    }\n  }\n\n  public componentWillUnmount() {\n    // Unregister Keytip in KeytipManager\n    this.props.keytipProps && this._keytipManager.unregister(this._getKtpProps(), this._uniqueId);\n  }\n\n  public componentDidUpdate(prevProps: IKeytipDataProps & IRenderComponent<{}>) {\n    if (prevProps.keytipProps !== this.props.keytipProps || prevProps.disabled !== this.props.disabled) {\n      // If keytipProps or disabled has changed update Keytip in KeytipManager\n      this.props.keytipProps && this._keytipManager.update(this._getKtpProps(), this._uniqueId);\n    }\n  }\n\n  public render(): JSX.Element {\n    const { children, keytipProps, ariaDescribedBy } = this.props;\n    let nativeKeytipProps: any = {};\n    if (keytipProps) {\n      nativeKeytipProps = this._getKtpAttrs(keytipProps, ariaDescribedBy);\n    }\n    return children(nativeKeytipProps);\n  }\n\n  private _getKtpProps(): IKeytipProps {\n    return {\n      disabled: this.props.disabled,\n      ...this.props.keytipProps!\n    };\n  }\n\n  /**\n   * Gets the aria- and data- attributes to attach to the component\n   * @param keytipProps - props for Keytip\n   * @param describedByPrepend - ariaDescribedBy value to prepend\n   */\n  private _getKtpAttrs(keytipProps: IKeytipProps, describedByPrepend?: string): any {\n    if (keytipProps) {\n      // Add the parent overflow sequence if necessary\n      const newKeytipProps = this._keytipManager.addParentOverflow(keytipProps);\n\n      // Construct aria-describedby and data-ktp-id attributes and return\n      const ariaDescribedBy = getAriaDescribedBy(newKeytipProps.keySequences);\n      let keySequences = [...newKeytipProps.keySequences];\n      if (newKeytipProps.overflowSetSequence) {\n        keySequences = mergeOverflows(keySequences, newKeytipProps.overflowSetSequence);\n      }\n      const ktpId = sequencesToID(keySequences);\n\n      return {\n        'aria-describedby': mergeAriaAttributeValues(describedByPrepend, ariaDescribedBy),\n        'data-ktp-target': ktpId,\n        'data-ktp-execute-target': ktpId\n      };\n    }\n    return undefined;\n  }\n}\n"]}