{"version":3,"file":"DetailsList.DragDrop.Example.js","sourceRoot":"../src/","sources":["components/DetailsList/examples/DetailsList.DragDrop.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport {\n  DetailsList,\n  Selection,\n  IColumn,\n  buildColumns,\n  IColumnReorderOptions,\n  IDragDropEvents,\n  IDragDropContext\n} from 'office-ui-fabric-react/lib/DetailsList';\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\nimport { createListItems, IExampleItem } from '@uifabric/example-data';\nimport { TextField, ITextFieldStyles } from 'office-ui-fabric-react/lib/TextField';\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\nimport { getTheme, mergeStyles } from 'office-ui-fabric-react/lib/Styling';\n\nconst theme = getTheme();\nconst margin = '0 30px 20px 0';\nconst dragEnterClass = mergeStyles({\n  backgroundColor: theme.palette.neutralLight\n});\nconst controlWrapperClass = mergeStyles({\n  display: 'flex',\n  flexWrap: 'wrap'\n});\nconst textFieldStyles: Partial<ITextFieldStyles> = {\n  root: { margin: margin },\n  fieldGroup: { maxWidth: '100px' }\n};\n\nexport interface IDetailsListDragDropExampleState {\n  items: IExampleItem[];\n  columns: IColumn[];\n  isColumnReorderEnabled: boolean;\n  frozenColumnCountFromStart: string;\n  frozenColumnCountFromEnd: string;\n}\n\nexport class DetailsListDragDropExample extends React.Component<{}, IDetailsListDragDropExampleState> {\n  private _selection: Selection;\n  private _dragDropEvents: IDragDropEvents;\n  private _draggedItem: IExampleItem | undefined;\n  private _draggedIndex: number;\n\n  constructor(props: {}) {\n    super(props);\n\n    this._selection = new Selection();\n    this._dragDropEvents = this._getDragDropEvents();\n    this._draggedIndex = -1;\n    const items = createListItems(10, 0);\n\n    this.state = {\n      items: items,\n      columns: buildColumns(items, true),\n      isColumnReorderEnabled: true,\n      frozenColumnCountFromStart: '1',\n      frozenColumnCountFromEnd: '0'\n    };\n  }\n\n  public render(): JSX.Element {\n    const { items, columns, isColumnReorderEnabled, frozenColumnCountFromStart, frozenColumnCountFromEnd } = this.state;\n\n    return (\n      <div>\n        <div className={controlWrapperClass}>\n          <Toggle\n            label=\"Enable column reorder\"\n            checked={isColumnReorderEnabled}\n            onChange={this._onChangeColumnReorderEnabled}\n            onText=\"Enabled\"\n            offText=\"Disabled\"\n            styles={{ root: { margin: margin } }}\n          />\n          <TextField\n            label=\"Number of left frozen columns\"\n            onGetErrorMessage={this._validateNumber}\n            value={frozenColumnCountFromStart}\n            onChange={this._onChangeStartCountText}\n            styles={textFieldStyles}\n          />\n          <TextField\n            label=\"Number of right frozen columns\"\n            onGetErrorMessage={this._validateNumber}\n            value={frozenColumnCountFromEnd}\n            onChange={this._onChangeEndCountText}\n            styles={textFieldStyles}\n          />\n        </div>\n        <MarqueeSelection selection={this._selection}>\n          <DetailsList\n            setKey=\"items\"\n            items={items}\n            columns={columns}\n            selection={this._selection}\n            selectionPreservedOnEmptyClick={true}\n            onItemInvoked={this._onItemInvoked}\n            onRenderItemColumn={this._onRenderItemColumn}\n            dragDropEvents={this._dragDropEvents}\n            columnReorderOptions={this.state.isColumnReorderEnabled ? this._getColumnReorderOptions() : undefined}\n            ariaLabelForSelectionColumn=\"Toggle selection\"\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n            checkButtonAriaLabel=\"Row checkbox\"\n          />\n        </MarqueeSelection>\n      </div>\n    );\n  }\n\n  private _handleColumnReorder = (draggedIndex: number, targetIndex: number) => {\n    const draggedItems = this.state.columns[draggedIndex];\n    const newColumns: IColumn[] = [...this.state.columns];\n\n    // insert before the dropped item\n    newColumns.splice(draggedIndex, 1);\n    newColumns.splice(targetIndex, 0, draggedItems);\n    this.setState({ columns: newColumns });\n  };\n\n  private _getColumnReorderOptions(): IColumnReorderOptions {\n    return {\n      frozenColumnCountFromStart: parseInt(this.state.frozenColumnCountFromStart, 10),\n      frozenColumnCountFromEnd: parseInt(this.state.frozenColumnCountFromEnd, 10),\n      handleColumnReorder: this._handleColumnReorder\n    };\n  }\n\n  private _validateNumber(value: string): string {\n    return isNaN(Number(value)) ? `The value should be a number, actual is ${value}.` : '';\n  }\n\n  private _onChangeStartCountText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, text: string): void => {\n    this.setState({ frozenColumnCountFromStart: text });\n  };\n\n  private _onChangeEndCountText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, text: string): void => {\n    this.setState({ frozenColumnCountFromEnd: text });\n  };\n\n  private _onChangeColumnReorderEnabled = (ev: React.MouseEvent<HTMLElement>, checked: boolean): void => {\n    this.setState({ isColumnReorderEnabled: checked });\n  };\n\n  private _getDragDropEvents(): IDragDropEvents {\n    return {\n      canDrop: (dropContext?: IDragDropContext, dragContext?: IDragDropContext) => {\n        return true;\n      },\n      canDrag: (item?: any) => {\n        return true;\n      },\n      onDragEnter: (item?: any, event?: DragEvent) => {\n        // return string is the css classes that will be added to the entering element.\n        return dragEnterClass;\n      },\n      onDragLeave: (item?: any, event?: DragEvent) => {\n        return;\n      },\n      onDrop: (item?: any, event?: DragEvent) => {\n        if (this._draggedItem) {\n          this._insertBeforeItem(item);\n        }\n      },\n      onDragStart: (item?: any, itemIndex?: number, selectedItems?: any[], event?: MouseEvent) => {\n        this._draggedItem = item;\n        this._draggedIndex = itemIndex!;\n      },\n      onDragEnd: (item?: any, event?: DragEvent) => {\n        this._draggedItem = undefined;\n        this._draggedIndex = -1;\n      }\n    };\n  }\n\n  private _onItemInvoked = (item: IExampleItem): void => {\n    alert(`Item invoked: ${item.name}`);\n  };\n\n  private _onRenderItemColumn = (item: IExampleItem, index: number, column: IColumn): JSX.Element | string => {\n    const key = column.key as keyof IExampleItem;\n    if (key === 'name') {\n      return <Link data-selection-invoke={true}>{item[key]}</Link>;\n    }\n\n    return String(item[key]);\n  };\n\n  private _insertBeforeItem(item: IExampleItem): void {\n    const draggedItems = this._selection.isIndexSelected(this._draggedIndex)\n      ? (this._selection.getSelection() as IExampleItem[])\n      : [this._draggedItem!];\n\n    const items = this.state.items.filter(itm => draggedItems.indexOf(itm) === -1);\n    let insertIndex = items.indexOf(item);\n\n    // if dragging/dropping on itself, index will be 0.\n    if (insertIndex === -1) {\n      insertIndex = 0;\n    }\n\n    items.splice(insertIndex, 0, ...draggedItems);\n\n    this.setState({ items: items });\n  }\n}\n"]}